{% extends 'layout.html' %}

{% block body %}

<style>
  .capitalize{
    text-transform: capitalize;
  }

  .loading,
  .error{
    text-align: center;
  }

  .panel {
    border-radius: 1px;
  }

  .card > .panel .panel-heading{
    background-color: #03A9F4!important;
  }


  .action_bar{
    background-color: #0288D1;
  }

  .action_bar{
    margin-bottom: 35px;
    padding-bottom: 40px;
  }

  .action_bar > .title{
    font-size: 24px;
  }

  .panel-title{
    color: rgb(255, 255, 255);
  }

  .row_key{
    font-weight: 600;
    text-align: center;
  }

  .row_val{
    text-align: center;
  }

  .main_card{
    border: none;
    box-shadow: 0 1px 1px rgba(0,0,0,0);
  }

  .main_card > .panel-body{
    box-shadow: 0 1px 1px rgba(0,0,0,0);
  }

  .module{
    font-size: 18px;
    font-weight: 600;
    background-color: #03A9F4;
  }

  .meta_heading{
      /*background-color: #2e6da4;*/
  }

  .loading,
  .error{
      margin-top: 40px;
  }

  .fa-spinner,
  .fa-meh-o,
  .error > span,
  .loading > span{
      color: #9E9E9E;
  }

  .error > span,
  .loading > span{
      margin-top: 5px;
  }

  .panel-heading {
      border-radius: 1px;
  }

  .table>thead>tr>th {
        border-bottom: 1px solid black;
  }

  tbody > tr:hover{
    background-color: #F5F5F5;
  }

  .btn{
    border-radius: 1px;
  }

  .btn-primary {
    background-color: #4FC3F7;
    border-color: #4FC3F7;
  }

  .modal-footer {
    border: none;
  }

  .modal-header{
    background-color: #03A9F4;
    color: white;
  }

  .close {
        float: right;
        font-size: 21px;
        font-weight: 700;
        line-height: 1;
        color: white;
        text-shadow: 0 1px 0 #fff;
        filter: alpha(opacity=20);
          opacity: 1;

    }





</style>

<img class="img-fluid" alt="Responsive image" src="{{url_for('static', filename='img/logo.png')}}">

<div class="panel panel-primary main_card">
  <div class="panel-heading action_bar">
    <div class="col-xs-9 title">Sensor Data</div>
    <div class="col-xs-3 btns">
      <button
        class="btn btn-success btn-md pull-right"
        ng-click="app.get_sensor_data()"
      >
        <span class="fa fa-refresh"></span>
        <span class="hidden-xs">Refresh Data</span>
      </button>
    </div>
  </div>
  <div class="panel-body">
      <!-- loading spinner -->
      <div class="loading" ng-if="app.loading_sensor_data">
          <div class="col-sm-12"><i class="fa fa-spinner fa-5x fa-spin" aria-hidden="true"></i></div>
          <span>fething data...</span>
      </div>

      <!-- error message -->
      <div class="error" ng-if="app.loading_sensor_error">
        <div class="col-sm-12"><i class="fa fa-meh-o fa-5x" aria-hidden="true"></i></div>
        <span>something went wrong...</span>
      </div>

      <div ng-if="!app.loading_sensor_data && !app.loading_sensor_error">
        <div class="card col-xs-12"
              ng-repeat="sensors in app.sensor_data">

          <div class="panel panel-default">
              <div class="panel-heading">
                <h3 class="panel-title module">Module: {[ sensors[0] ]}</h3>
              </div>
              <div class="panel-body">
                <div class="table-responsive">
                  <table class="table">
                      <thead>
                        <tr>
                          <th class="row_key">Payload</th>
                          <th ng-repeat="key in app.ordered_key"
                              class="row_key capitalize">
                              {[ app.format_label(key) ]}
                          </th>
                          <th class="row_key">Meta</th>
                        </tr>
                      </thead>
                      <tr ng-repeat="sensor in sensors[1]">
                        <td class="row_val">{[ sensor['pld_string'] ]}</td>
                        <td  ng-repeat="key in app.ordered_key"
                              ng-if="sensor['sensor_data'][key] != undefined"
                            class="row_val">
                            {[ app.format_value(key, sensor['sensor_data'][key]) ]}
                        </td>
                        <td class="row_val"><button class="btn btn-primary btn-xs" ng-click="app.meta_modal(sensor)">View Meta</button></td>
                      </tr>
                    </table>
                </div>
          </div>
        </div>
    </div>
  </div>
</div>
{% endblock %}
